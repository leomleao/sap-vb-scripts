If Not IsObject(application) Then
   Set SapGuiAuto  = GetObject("SAPGUI")
   Set application = SapGuiAuto.GetScriptingEngine
End If
If Not IsObject(connection) Then
   Set connection = application.Children(0)
End If
If Not IsObject(session) Then
   Set session    = connection.Children(0)
End If
If IsObject(WScript) Then
   WScript.ConnectObject session,     "on"
   WScript.ConnectObject application, "on"
End If


strData = "8006-0100|60308991,1,8006-0100|60397007,2,8006-0100|60396980,1,8006-0100|60396982,3,8006-0100|60396984,1,8006-0100|60396990,1,8006-0100|60385660,5,8006-0100|60527691,2,8006-0100|60527692,1,8006-0100|60527695,3,8006-0100|60527696,3,8006-0100|60527698,3,8006-0100|60527699,3,8006-0100|60527700,4,8006-0100|60527701,3,8006-0100|60527826,2,8006-0100|60527827,6,8006-0100|60527828,10,8006-0100|60527829,4,8006-0100|60527830,1,8006-0100|60527920,1,8006-0100|60527925,2,8006-0100|60527935,4,8006-0100|60527937,3,8006-0100|60527938,2,8006-0100|60527949,1,8006-0100|60527950,5,8006-0100|60527951,1,8006-0100|60527953,1,8006-0100|60527954,1,8006-0100|60528041,2,8006-0100|60528043,3,8006-0100|60528052,7,8006-0100|60528054,4,8006-0100|60528065,4,8006-0100|60528066,1,8006-0100|60528073,2,8006-0100|60528074,1,8006-0100|60528075,1,8006-0100|60528083,2,8006-0100|60528084,1,8006-0100|60528085,1,8006-0100|60528088,1,8006-0100|60528090,1,8006-0100|60528095,3,8006-0100|60528098,3,8006-0100|60528102,2,8006-0100|60528108,2,8006-0100|60528119,3,8006-0100|60528120,1,8006-0100|60528128,7,8006-0100|60528129,1,8006-0100|60528130,1,8006-0100|60528138,1,8006-0100|60528131,1,8006-0100|60528132,1,8006-0100|60528133,1,8006-0100|60528134,1,8006-0100|60528146,1,8006-0100|60528144,5,8006-0100|60528143,2,8006-0100|60528148,1,8006-0100|60528149,1,8006-0100|60528150,4,8006-0100|60528151,2,8006-0100|60528152,1,8006-0100|60528192,2,8006-0100|60528237,1,8006-0100|60528238,1,8006-0100|60528239,1,8006-0100|60528210,1,8006-0100|60528211,1,8006-0100|60528202,1,8006-0100|60528205,2"

arr = Split(strData,",")

session.findById("wnd[0]/tbar[0]/okcd").text = "/nMIGO"
session.findById("wnd[0]").sendVKey 0

session.findById("wnd[0]/shellcont/shell/shellcont[1]/shell[1]").topNode = "          1"
session.findById("wnd[0]/usr/ssubSUB_MAIN_CARRIER:SAPLMIGO:0003/subSUB_FIRSTLINE:SAPLMIGO:0011/cmbGODYNPRO-ACTION").key = "A01"
session.findById("wnd[0]/usr/ssubSUB_MAIN_CARRIER:SAPLMIGO:0003/subSUB_FIRSTLINE:SAPLMIGO:0011/cmbGODYNPRO-REFDOC").key = "R10"
session.findById("wnd[0]/usr/ssubSUB_MAIN_CARRIER:SAPLMIGO:0003/subSUB_FIRSTLINE:SAPLMIGO:0011/ctxtGODEFAULT_TV-BWART").text = "912"

itemTab = "wnd[0]/usr/ssubSUB_MAIN_CARRIER:SAPLMIGO:0003/subSUB_ITEMDETAIL:SAPLMIGO:0301/subSUB_DETAIL:SAPLMIGO:0300/"

For i = 0 To UBound(arr)    
    session.findById("wnd[0]").sendVKey 0
    session.findById(itemTab & "tabsTS_GOITEM/tabpOK_GOITEM_MATERIAL/ssubSUB_TS_GOITEM_MATERIAL:SAPLMIGO:0310/ctxtGOITEM-MAKTX").text = arr(i)
    session.findById("wnd[0]").sendVKey 0
    i = i + 1
    session.findById(itemTab & "tabsTS_GOITEM/tabpOK_GOITEM_QUANTITIES").select
    session.findById(itemTab & "tabsTS_GOITEM/tabpOK_GOITEM_QUANTITIES/ssubSUB_TS_GOITEM_QUANTITIES:SAPLMIGO:0315/txtGOITEM-ERFMG").text = arr(i)
    session.findById("wnd[0]").sendVKey 0
    session.findById(itemTab & "tabsTS_GOITEM/tabpOK_GOITEM_DESTINAT.").select
    session.findById(itemTab & "tabsTS_GOITEM/tabpOK_GOITEM_DESTINAT./ssubSUB_TS_GOITEM_DESTINATION:SAPLMIGO:0325/ctxtGOITEM-NAME1").text = "0008"
    session.findById("wnd[0]").sendVKey 0
    session.findById(itemTab & "tabsTS_GOITEM/tabpOK_GOITEM_DESTINAT./ssubSUB_TS_GOITEM_DESTINATION:SAPLMIGO:0325/ctxtGOITEM-LGOBE").text = "0001"
    session.findById("wnd[0]").sendVKey 0
    session.findById(itemTab & "tabsTS_GOITEM/tabpOK_GOITEM_BATCH").select
    session.findById(itemTab & "tabsTS_GOITEM/tabpOK_GOITEM_BATCH/ssubSUB_TS_GOITEM_BATCH:SAPLMIGO:0335/ctxtGOITEM-CHARG").text = "0000999908"
    session.findById("wnd[0]").sendVKey 0
    session.findById(itemTab & "btnOK_NEXT_ITEM").press
Next








