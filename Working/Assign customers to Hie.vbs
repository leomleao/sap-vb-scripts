If Not IsObject(application) Then
   Set SapGuiAuto  = GetObject("SAPGUI")
   Set application = SapGuiAuto.GetScriptingEngine
End If
If Not IsObject(connection) Then
   Set connection = application.Children(0)
End If
If Not IsObject(session) Then
   Set session    = connection.Children(0)
End If
If IsObject(WScript) Then
   WScript.ConnectObject session,     "on"
   WScript.ConnectObject application, "on"
End If

session.findById("wnd[0]/tbar[0]/okcd"). Text = "/nVDH1N"
session.findById("wnd[0]").sendVKey 0

topLevel = "92870"
strData =  "808545,812190,7305640,7313937,7327697,7327708,7329485,7335922,7385273,7410628,7416267,7419878,7419879,7420018,7423079,7428492,7429441,7308351,7326472,7438325,7445568,7480846,7330525,7430712,807593,807610,807740,807999,808090,808166,808330,808490,808548,808582,808636,808792,808797,808861,809120,809225,809295,809301,809356,7457673,809383,809407,809420,809492,809555,809590,809603,809667,809718,809762,809763,809797,809856,809857,809920,809927,809987,810013,810115,810116,810117,810124,810150,7492814,810221,810227,810233,810242,810292,810311,810339,810347,810403,810409,810414,810470,7311073,810519,810520,810543,810544,810571,810646,810650,810653,810715,810717,811575,813297,813402,7305347,7308826,7314364,809390,813319,7309188,7312297,7313160,7313717,7313888,7313915,7316297,7316315,7317723,7317746,7319037,7321931,7324983,7325444,7325555,7327023,7331493,7334228,7334889,7373182,7379906,7381065,810078,810674,812006,812177,7310522,7311878,7313564,7313780,7314315,7316129,7316281,7317332,7318056,7318928,7318992,7321230,7323232,7324740,7326993,7328062,7331198,7331680,7333880,7334485,7336549,7374372,7381415,7381928,7391033,7391279,7391303,7402062,7402063,7404044,7408982,7408985,801676,810062,810512,810645,810677,7307526,7309022,7305349,7307395,7307607,7307995,800021,803511,804372,805496,806545,806616,807045,807169,807370,807449,7309086,7309399,7309464,7309581,7310992,7312145,7313190,7313726,7314092,7314105,7314451,7315200,7315883,7316076,7316298,7316748,7317073,7324348,7324923,7332524,810565,7334437,7334887,7336594,7381866,7382381,7383089,7388926,7407202,7461573,7408986,7323977,7330359,7381350,7383167,7389924,7408307,7374786,7410914,7411384,806538,7392449,7411363,7414655,7415218,7415439,7410075,7411098,7411995,807187,807869,7305353,7431981,7436698,7437230,7429648,7443467,7443775,7380941,7447295,7443412,7448393,7447546,811920,7447629,7421622,7451017,7435463,7448440,7451180,7385573,7387955,7459336,7460337,7451104,7312510,7462759,7449909,7460329,7489978,7491080,811603,7425262,7415872,7463350,7459859,810063,7461678,810466,7465907,7435627,7459864,7475804,7387306,801042,7438856,7449453,7469139,7306915,7462022,7469231,806669,810598,811202,7460641,7314157,7466236,7421899,7480573,7477589,807278,7461296,7482073,7476446,7418643,7449270,7334932,7481684,7483437,7482234,7489416,809900,7481747,810073,7480335,7483937,7485908,7450088,7447924,7373365,812074,7485577,7484377,7480384,808794,7323182,7318679,7486229,7482684,7484973,7490231,7324175,7489219,7478711,7488293,7491803,7412718,7485672,7477281,807648,7317019,7492056,7487509"

currentDate = Day(Now) & "." & Month(Now) & "." & Year(Now)
startDate = "01.01.2020"


session.findById("wnd[0]/usr/ctxtS_DATE").text = currentDate
session.findById("wnd[0]/usr/ctxtS_KUNNR-LOW").text = topLevel
session.findById("wnd[0]/usr/ctxtS_DATE").setFocus
session.findById("wnd[0]/usr/ctxtS_DATE").caretPosition = 2
session.findById("wnd[0]/tbar[1]/btn[8]").press


arr = Split(strData,",")

For i = 0 To UBound(arr)
   session.findById("wnd[0]/tbar[1]/btn[27]").press
   session.findById("wnd[0]/usr/ctxtKNVH-HKUNNR").text = topLevel
   session.findById("wnd[0]/usr/ctxtKNVH-HVKORG").text = "0008"
   session.findById("wnd[0]/usr/ctxtKNVH-HVTWEG").text = "00"
   session.findById("wnd[0]/usr/ctxtKNVH-HSPART").text = "00"
   session.findById("wnd[0]/usr/ctxtKNVH-VKORG").text = "0008"
   session.findById("wnd[0]/usr/ctxtKNVH-VTWEG").text = "00"
   session.findById("wnd[0]/usr/ctxtKNVH-SPART").text = "00"
   session.findById("wnd[0]/usr/ctxtKNVH-KUNNR").text = arr(i)
   session.findById("wnd[0]/usr/ctxtKNVH-HKUNNR").caretPosition = 5
   session.findById("wnd[0]/usr/ctxtKNVH-DATAB").text = startDate
   session.findById("wnd[0]/usr/btnDVF_GET_DETAIL_BUTTON").press
Next




